<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
    <title>Elvi Ezra - Cosmic Orb</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        /* General Body Styles */
        body {
            margin: 0;
            font-family: 'Space Mono', monospace; /* Futuristic font */
            color: #E0E0E0; /* Light gray for text on dark background */
            background-color: #000005; /* Near black for deep space background */
            overflow: auto; /* Allow scrolling for the large content area */
            cursor: url('data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"30\" height=\"30\" viewBox=\"0 0 24 24\" fill=\"%2300FFFF\"><circle cx=\"12\" cy=\"12\" r=\"2\" opacity=\"0.8\"/><path d=\"M12 0L12 6M0 12L6 12M12 18L12 24M18 12L24 12\" stroke=\"%2300FFFF\" stroke-width=\"1.5\"/></svg>') 15 15, auto;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            flex-direction: column;
            position: relative;
        }

        /* Particles animation - stays the same */
        .particle {
            position: absolute;
            background: #00FFFF; /* Cyan */
            border-radius: 50%;
            animation: floatAndFade 15s infinite ease-in-out;
            opacity: 0;
        }

        @keyframes floatAndFade {
            0% { transform: translate(0, 0) scale(0.5); opacity: 0; }
            25% { opacity: 0.8; }
            50% { transform: translate(calc(var(--rand-x) * 1px), calc(var(--rand-y) * 1px)) scale(var(--rand-scale)); opacity: 0.6; }
            75% { opacity: 0.4; }
            100% { transform: translate(calc(var(--rand-x) * 2px), calc(var(--rand-y) * 2px)) scale(0); opacity: 0; }
        }

        /* Main Content Wrapper */
        .content-wrapper {
            position: relative;
            z-index: 10; /* Above particles */
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            box-sizing: border-box;
            max-width: 1200px;
            width: 100%;
        }

        /* Hero Section - stays the same */
        .hero-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            margin-bottom: 50px;
        }

        .profile-orb {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            background: linear-gradient(45deg, #00FFFF, #8A2BE2); /* Cyan to Blue Violet */
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 20px;
            box-shadow: 0 0 30px rgba(0, 255, 255, 0.7), 0 0 60px rgba(138, 43, 226, 0.5);
            animation: pulse 3s infinite alternate;
            position: relative; /* Needed for absolute positioning of inner elements */
        }

        @keyframes pulse {
            0% { transform: scale(1); box-shadow: 0 0 30px rgba(0, 255, 255, 0.7), 0 0 60px rgba(138, 43, 226, 0.5); }
            100% { transform: scale(1.05); box-shadow: 0 0 40px rgba(0, 255, 255, 0.9), 0 0 80px rgba(138, 43, 226, 0.7); }
        }

        .profile-orb img {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            border: 4px solid #E0E0E0;
            object-fit: cover;
        }

        .elvi-name {
            font-size: 3em;
            color: #00FFFF;
            text-shadow: 0 0 15px #00FFFF;
            margin-bottom: 10px;
        }

        .cosmic-title {
            font-size: 1.5em;
            color: #8A2BE2;
            text-shadow: 0 0 10px #8A2BE2;
        }

        /* Dynamic stat elements within the orb */
        .orb-stat {
            position: absolute;
            color: #E0E0E0;
            text-align: center;
            font-size: 0.9em;
            text-shadow: 0 0 5px rgba(0, 255, 255, 0.5);
        }

        .orb-stat .stat-value {
            font-size: 1.5em;
            font-weight: bold;
            display: block;
            margin-bottom: 5px;
            color: #00FFFF;
        }

        .orb-stat .stat-label {
            font-size: 0.8em;
            color: #999;
        }

        /* Positioning for new stats */
        /* Kunjungan (replacing Orbiting) - Top Right */
        .orb-stat.visits {
            top: 20px;
            right: 20px;
            transform: translate(20px, -20px); /* Adjust to be outside the orb a bit */
        }

        /* Media Count (replacing Cosmic Being) - Bottom Right */
        .orb-stat.media {
            bottom: 20px;
            right: 20px;
            transform: translate(20px, 20px); /* Adjust to be outside the orb a bit */
        }

        /* Website Age (new) - Bottom Left */
        .orb-stat.website-age {
            bottom: 20px;
            left: 20px;
            transform: translate(-20px, 20px); /* Adjust to be outside the orb a bit */
        }

        /* Social Links - stays the same */
        .social-links {
            margin-top: 30px;
            display: flex;
            gap: 25px;
        }

        .social-links a {
            color: #E0E0E0;
            font-size: 2em;
            transition: color 0.3s ease, transform 0.3s ease;
        }

        .social-links a:hover {
            color: #00FFFF;
            transform: translateY(-5px);
        }

        /* Sections (About, Projects, Contact) - stays the same */
        .section {
            background-color: rgba(10, 10, 30, 0.8); /* Darker, slightly transparent */
            border-radius: 10px;
            padding: 30px;
            margin-bottom: 30px;
            width: 100%;
            max-width: 800px;
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.2);
            border: 1px solid rgba(0, 255, 255, 0.3);
        }

        .section h2 {
            color: #00FFFF;
            font-size: 2em;
            margin-bottom: 20px;
            text-align: center;
            border-bottom: 2px solid #8A2BE2;
            padding-bottom: 10px;
        }

        .section p, .section ul {
            font-size: 1.1em;
            line-height: 1.6;
            color: #C0C0C0;
        }

        .section ul {
            list-style: none;
            padding: 0;
        }

        .section ul li {
            margin-bottom: 10px;
            padding-left: 25px;
            position: relative;
        }

        .section ul li::before {
            content: "\f111"; /* FontAwesome circle icon */
            font-family: "Font Awesome 5 Free";
            font-weight: 900;
            color: #8A2BE2;
            position: absolute;
            left: 0;
            top: 0;
        }

        /* Gallery Section - New */
        .media-gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .media-item {
            background-color: rgba(20, 20, 40, 0.9);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 0 10px rgba(0, 255, 255, 0.1);
            text-align: center;
            transition: transform 0.3s ease;
        }

        .media-item:hover {
            transform: translateY(-5px);
        }

        .media-item img, .media-item video {
            width: 100%;
            height: 120px;
            object-fit: cover;
            display: block;
        }

        .media-item p {
            font-size: 0.8em;
            color: #B0B0B0;
            padding: 8px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* File Upload Section */
        .upload-section {
            background-color: rgba(10, 10, 30, 0.8);
            border-radius: 10px;
            padding: 30px;
            margin-bottom: 30px;
            width: 100%;
            max-width: 800px;
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.2);
            border: 1px solid rgba(0, 255, 255, 0.3);
            text-align: center;
        }

        .upload-section h2 {
            color: #00FFFF;
            font-size: 2em;
            margin-bottom: 20px;
            border-bottom: 2px solid #8A2BE2;
            padding-bottom: 10px;
        }

        .upload-section input[type="file"] {
            display: block;
            margin: 0 auto 20px auto;
            padding: 10px;
            border: 1px solid #00FFFF;
            border-radius: 5px;
            background-color: #0a0a1e;
            color: #E0E0E0;
            width: fit-content;
            cursor: pointer;
        }
        
        .upload-section input[type="file"]::file-selector-button {
            background-color: #8A2BE2;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .upload-section input[type="file"]::file-selector-button:hover {
            background-color: #6a0ad2;
        }

        .upload-section button {
            background-color: #00FFFF;
            color: #000005;
            padding: 12px 25px;
            border: none;
            border-radius: 5px;
            font-size: 1.1em;
            cursor: pointer;
            transition: background-color 0.3s ease;
            font-family: 'Space Mono', monospace;
            font-weight: bold;
        }

        .upload-section button:hover {
            background-color: #00E5E5;
        }

        #uploadStatus {
            margin-top: 15px;
            font-size: 0.95em;
            color: #E0E0E0;
        }

        /* Editor Overlay (for Admin) - same as before */
        .editor-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.95);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .editor-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .editor-content {
            background-color: #1a1a2e;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 0 30px rgba(0, 255, 255, 0.5);
            width: 90%;
            max-width: 600px;
            color: #E0E0E0;
            position: relative;
            max-height: 90vh;
            overflow-y: auto;
        }

        .editor-content h2 {
            color: #00FFFF;
            text-align: center;
            margin-bottom: 25px;
        }

        .editor-content label {
            display: block;
            margin-bottom: 8px;
            color: #B0B0B0;
        }

        .editor-content input[type="text"],
        .editor-content textarea {
            width: calc(100% - 20px);
            padding: 10px;
            margin-bottom: 20px;
            border: 1px solid #8A2BE2;
            border-radius: 5px;
            background-color: #0d0d1a;
            color: #E0E0E0;
            font-family: 'Space Mono', monospace;
            box-sizing: border-box;
        }

        .editor-content textarea {
            resize: vertical;
            min-height: 100px;
        }

        .editor-actions {
            display: flex;
            justify-content: space-around;
            margin-top: 30px;
        }

        .editor-actions button {
            background-color: #00FFFF;
            color: #000005;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-family: 'Space Mono', monospace;
            font-weight: bold;
            transition: background-color 0.3s ease;
        }

        .editor-actions button:hover {
            background-color: #00E5E5;
        }

        .editor-actions button.cancel {
            background-color: #8A2BE2;
        }

        .editor-actions button.cancel:hover {
            background-color: #6a0ad2;
        }

        .close-editor {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.5em;
            color: #8A2BE2;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .close-editor:hover {
            color: #00FFFF;
        }

        /* Footer - stays the same */
        footer {
            margin-top: 50px;
            padding: 20px;
            text-align: center;
            color: #7f8c8d;
            font-size: 0.9em;
            width: 100%;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .profile-orb {
                width: 150px;
                height: 150px;
            }

            .profile-orb img {
                width: 90px;
                height: 90px;
            }

            .elvi-name {
                font-size: 2.2em;
            }

            .cosmic-title {
                font-size: 1.2em;
            }

            .orb-stat {
                font-size: 0.7em;
            }
            .orb-stat .stat-value {
                font-size: 1.2em;
            }
            .orb-stat.visits { top: 10px; right: 10px; transform: translate(10px, -10px); }
            .orb-stat.media { bottom: 10px; right: 10px; transform: translate(10px, 10px); }
            .orb-stat.website-age { bottom: 10px; left: 10px; transform: translate(-10px, 10px); }

            .social-links {
                gap: 15px;
            }

            .social-links a {
                font-size: 1.5em;
            }

            .section, .upload-section {
                padding: 20px;
            }

            .section h2, .upload-section h2 {
                font-size: 1.8em;
            }

            .editor-content {
                padding: 20px;
            }
        }

        @media (max-width: 480px) {
            .profile-orb {
                width: 120px;
                height: 120px;
            }

            .profile-orb img {
                width: 70px;
                height: 70px;
            }

            .elvi-name {
                font-size: 1.8em;
            }

            .cosmic-title {
                font-size: 1em;
            }

            .orb-stat {
                font-size: 0.6em;
            }
            .orb-stat .stat-value {
                font-size: 1em;
            }
        }
    </style>
</head>
<body>
    <div id="particles"></div>

    <div class="content-wrapper">
        <section class="hero-section">
            <div class="profile-orb">
                <img id="profile-picture" src="https://i.ibb.co/L5Q1dF6/me.jpg" alt="Elvi Ezra">
                
                <div class="orb-stat visits">
                    <i class="fas fa-eye"></i>
                    <span id="website-visits" class="stat-value">---</span>
                    <span class="stat-label">Total Visits</span>
                </div>
                <div class="orb-stat media">
                    <i class="fas fa-folder-open"></i>
                    <span id="media-count" class="stat-value">---</span>
                    <span class="stat-label">Media Count</span>
                </div>
                <div class="orb-stat website-age">
                    <i class="fas fa-clock"></i>
                    <span id="website-age" class="stat-value">---</span>
                    <span class="stat-label">Website Age</span>
                </div>

            </div>
            <h1 class="elvi-name" id="profile-name">Elvi Ezra</h1>
            <p class="cosmic-title" id="profile-title">Cosmic Orb</p>
            <div class="social-links">
                <a href="#" onclick="openTikTok()" title="TikTok"><i class="fab fa-tiktok"></i></a>
                <a href="#" onclick="openInstagram()" title="Instagram"><i class="fab fa-instagram"></i></a>
            </div>
        </section>

        <section class="section" id="about-me">
            <h2>About Me</h2>
            <p id="about-content">Greetings, cosmic travelers. I am Elvi Ezra, an entity of light and code, navigating the vast expanse of the digital cosmos. My journey is one of discovery, creation, and connection. I thrive on the ethereal glow of innovation and the vibrant pulse of human interaction.</p>
        </section>

        <section class="section" id="my-projects">
            <h2>My Cosmic Projects</h2>
            <ul id="projects-list">
                <li><i class="fas fa-rocket"></i> Project Alpha: A decentralized neural network for interstellar communication.</li>
                <li><i class="fas fa-gem"></i> Gemstone Protocol: An encrypted ledger for cosmic resource trading.</li>
                <li><i class="fas fa-meteor"></i> Meteoroid Navigator: An AI-powered guide for asteroid field traversal.</li>
            </ul>
        </section>

        <section class="upload-section">
            <h2>Unggah Media Anda ke Cosmos</h2>
            <form id="uploadForm">
                <input type="file" id="mediaFile" name="mediaFiles" multiple>
                <button type="submit">Unggah ke Orb</button>
                <p id="uploadStatus"></p>
            </form>
        </section>

        <section class="section" id="contact">
            <h2>Connect with the Cosmos</h2>
            <p id="contact-content">If you wish to send a signal across the void, you can reach me through these channels or click the orb to edit.</p>
            </section>

        <footer>
            <p>&copy; 2025 Elvi Ezra. All rights reserved. Powered by Stardust and Code.</p>
        </footer>
    </div>

    <div class="editor-overlay" id="editorOverlay">
        <div class="editor-content">
            <span class="close-editor" id="closeEditor">&times;</span>
            <h2>Edit Cosmic Data</h2>
            <label for="edit-name">Profile Name:</label>
            <input type="text" id="edit-name">

            <label for="edit-title">Cosmic Title:</label>
            <input type="text" id="edit-title">

            <label for="edit-about">About Me:</label>
            <textarea id="edit-about"></textarea>

            <label for="edit-projects">My Cosmic Projects (one per line):</label>
            <textarea id="edit-projects"></textarea>

            <div class="editor-actions">
                <button id="publishChangesBtn">Publish to Galaxy</button>
                <button class="cancel" id="cancelEditBtn">Cancel</button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- Particle Background Initialization ---
            const particlesContainer = document.getElementById('particles');
            const numParticles = 80;

            for (let i = 0; i < numParticles; i++) {
                const particle = document.createElement('div');
                particle.classList.add('particle');
                const size = Math.random() * 5 + 2; // Size between 2px and 7px
                particle.style.width = `${size}px`;
                particle.style.height = `${size}px`;
                particle.style.left = `${Math.random() * 100}%`;
                particle.style.top = `${Math.random() * 100}%`;
                particle.style.animationDelay = `${Math.random() * -15}s`; // Start at various points in animation
                particle.style.setProperty('--rand-x', Math.random() * 400 - 200); // -200 to 200
                particle.style.setProperty('--rand-y', Math.random() * 400 - 200); // -200 to 200
                particle.style.setProperty('--rand-scale', Math.random() * 0.5 + 0.5); // 0.5 to 1.0
                particlesContainer.appendChild(particle);
            }

            // --- Admin Editor Logic (Unchanged from your original) ---
            const profileOrb = document.querySelector('.profile-orb');
            const editorOverlay = document.getElementById('editorOverlay');
            const closeEditorBtn = document.getElementById('closeEditor');
            const cancelEditBtn = document.getElementById('cancelEditBtn');
            const publishChangesBtn = document.getElementById('publishChangesBtn');

            const editName = document.getElementById('edit-name');
            const editTitle = document.getElementById('edit-title');
            const editAbout = document.getElementById('edit-about');
            const editProjects = document.getElementById('edit-projects');

            const profileName = document.getElementById('profile-name');
            const profileTitle = document.getElementById('profile-title');
            const aboutContent = document.getElementById('about-content');
            const projectsList = document.getElementById('projects-list');

            let currentProfileData = {
                name: "Elvi Ezra",
                title: "Cosmic Orb",
                about: "Greetings, cosmic travelers. I am Elvi Ezra, an entity of light and code, navigating the vast expanse of the digital cosmos. My journey is one of discovery, creation, and connection. I thrive on the ethereal glow of innovation and the vibrant pulse of human interaction.",
                projects: [
                    "Project Alpha: A decentralized neural network for interstellar communication.",
                    "Gemstone Protocol: An encrypted ledger for cosmic resource trading.",
                    "Meteoroid Navigator: An AI-powered guide for asteroid field traversal."
                ]
            };

            // Load content from localStorage or default
            function loadProfileContent() {
                const storedData = localStorage.getItem('elviProfileData');
                if (storedData) {
                    currentProfileData = JSON.parse(storedData);
                }

                profileName.textContent = currentProfileData.name;
                profileTitle.textContent = currentProfileData.title;
                aboutContent.textContent = currentProfileData.about;
                
                projectsList.innerHTML = '';
                currentProfileData.projects.forEach(project => {
                    const li = document.createElement('li');
                    li.innerHTML = `<i class="fas fa-rocket"></i> ${project}`;
                    projectsList.appendChild(li);
                });
            }

            profileOrb.addEventListener('click', () => {
                editName.value = currentProfileData.name;
                editTitle.value = currentProfileData.title;
                editAbout.value = currentProfileData.about;
                editProjects.value = currentProfileData.projects.join('\n');
                editorOverlay.classList.add('active');
            });

            closeEditorBtn.addEventListener('click', () => {
                editorOverlay.classList.remove('active');
            });

            cancelEditBtn.addEventListener('click', () => {
                editorOverlay.classList.remove('active');
            });

            // --- IMPORTANT: Configure your Cloudflare Worker API URL here ---
            // After deploying your Cloudflare Worker, Cloudflare will give you a URL.
            // Replace 'https://your-worker-name.your-username.workers.dev' with that actual URL.
            const API_BASE_URL = 'https://your-worker-name.your-username.workers.dev'; 

            async function publishChangesToBackend() {
                const updatedData = {
                    name: editName.value,
                    title: editTitle.value,
                    about: editAbout.value,
                    projects: editProjects.value.split('\n').filter(p => p.trim() !== '')
                };

                try {
                    // This section assumes your backend can handle profile data updates.
                    // The Cloudflare Worker example below focuses on stats and media.
                    // You'd need to extend your Worker to store/retrieve this profile data,
                    // perhaps in another KV namespace or D1 database.
                    // For now, we'll just update localStorage.

                    currentProfileData = updatedData;
                    localStorage.setItem('elviProfileData', JSON.stringify(currentProfileData));
                    alert('Changes successfully saved locally!');
                    editorOverlay.classList.remove('active');
                    loadProfileContent(); // Reload the website with the new data
                } catch (error) {
                    console.error('Error publishing changes:', error);
                    alert(`Failed to publish changes: ${error.message}.`);
                }
            }

            publishChangesBtn.addEventListener('click', publishChangesToBackend);

            // Global functions (can be called from HTML)
            function openTikTok() {
                window.open("https://vm.tiktok.com/ZShf4GMgT/", "_blank");
            }

            function openInstagram() {
                window.open("https://www.instagram.com/elvizill/", "_blank");
            }

            loadProfileContent(); // Load existing profile content on page load

            // --- NEW: Website Age Feature ---
            // Set your website's launch date here (Year, Month-1, Day, Hour, Minute, Second)
            // Example: June 20, 2024 at 10:00:00 AM WIB -> new Date(2024, 5, 20, 10, 0, 0)
            const WEBSITE_LAUNCH_DATE = new Date(2025, 5, 20, 8, 40, 0); // Assuming today (June 20, 2025, 08:40 AM WIB) as launch

            function updateWebsiteAge() {
                const now = new Date();
                const diffMs = now - WEBSITE_LAUNCH_DATE;

                // Handle cases where launch date is in the future
                if (diffMs < 0) {
                    document.getElementById('website-age').textContent = 'Launching Soon!';
                    return;
                }

                const totalSeconds = Math.floor(diffMs / 1000);
                
                const years = Math.floor(totalSeconds / (365.25 * 24 * 60 * 60));
                const remainingSecondsAfterYears = totalSeconds % (365.25 * 24 * 60 * 60);

                const months = Math.floor(remainingSecondsAfterYears / (30.44 * 24 * 60 * 60));
                const remainingSecondsAfterMonths = remainingSecondsAfterYears % (30.44 * 24 * 60 * 60);

                const days = Math.floor(remainingSecondsAfterMonths / (24 * 60 * 60));
                const remainingSecondsAfterDays = remainingSecondsAfterMonths % (24 * 60 * 60);

                const hours = Math.floor(remainingSecondsAfterDays / (60 * 60));
                const remainingSecondsAfterHours = remainingSecondsAfterDays % (60 * 60);

                const minutes = Math.floor(remainingSecondsAfterHours / 60);
                const seconds = remainingSecondsAfterHours % 60;

                document.getElementById('website-age').textContent = 
                    `${years}Y ${months}M ${days}D ${hours}h ${minutes}m ${seconds}s`;
            }

            // Update immediately and then every second
            updateWebsiteAge();
            setInterval(updateWebsiteAge, 1000);

            // --- NEW: Fetch Website Stats (Visits & Media Count) ---
            async function fetchWebsiteStats() {
                try {
                    const response = await fetch(`${API_BASE_URL}/stats`);
                    if (!response.ok) {
                        const errorText = await response.text();
                        throw new Error(`HTTP error! status: ${response.status}, message: ${errorText}`);
                    }
                    const data = await response.json();
                    
                    document.getElementById('website-visits').textContent = data.visits.toLocaleString();
                    document.getElementById('media-count').textContent = data.mediaCount.toLocaleString();

                } catch (error) {
                    console.error('Gagal mengambil statistik website:', error);
                    document.getElementById('website-visits').textContent = 'Error!';
                    document.getElementById('media-count').textContent = 'Error!';
                }
            }

            async function recordVisitAndFetchStats() {
                try {
                    // Send a POST request to record the visit
                    await fetch(`${API_BASE_URL}/visit`, { method: 'POST' });
                } catch (error) {
                    console.warn('Gagal mencatat kunjungan (mungkin backend belum siap):', error);
                } finally {
                    // Always try to fetch stats, even if visit recording failed
                    fetchWebsiteStats(); 
                }
            }

            // Record a visit and fetch stats when the page loads
            recordVisitAndFetchStats();


            // --- NEW: Media Upload Functionality ---
            const uploadForm = document.getElementById('uploadForm');
            const uploadStatus = document.getElementById('uploadStatus');

            uploadForm.addEventListener('submit', async (event) => {
                event.preventDefault();

                const fileInput = document.getElementById('mediaFile');
                const files = fileInput.files;

                if (files.length === 0) {
                    uploadStatus.textContent = 'Pilih setidaknya satu file untuk diunggah.';
                    uploadStatus.style.color = 'orange';
                    return;
                }

                uploadStatus.textContent = 'Mengunggah ke Cosmos...';
                uploadStatus.style.color = '#00FFFF'; // Cosmic blue

                const formData = new FormData();
                for (let i = 0; i < files.length; i++) {
                    formData.append('mediaFiles', files[i]); // 'mediaFiles' must match backend field name
                }

                try {
                    const response = await fetch(`${API_BASE_URL}/upload`, {
                        method: 'POST',
                        body: formData,
                    });

                    if (response.ok) {
                        const result = await response.json();
                        uploadStatus.textContent = `Berhasil mengunggah ${result.uploadedCount} file ke galaksi!`;
                        uploadStatus.style.color = '#28a745'; // Green success
                        fileInput.value = ''; // Reset input file
                        fetchWebsiteStats(); // Refresh
                    } else {
                        const errorText = await response.text();
                        throw new Error(`HTTP error! status: ${response.status}, message: ${errorText}`);
                    }
                } catch (error) {
                    console.error('Error uploading files:', error);
                    uploadStatus.textContent = `Gagal mengunggah file: ${error.message}`;
                    uploadStatus.style.color = '#dc3545'; // Red error
                }
            });
        });

        // Global functions (not part of DOMContentLoaded, can be called from HTML)
        function openTikTok() {
            window.open("https://vm.tiktok.com/ZShf4GMgT/", "_blank");
        }

        function openInstagram() {
            window.open("https://www.instagram.com/elvizill/", "_blank");
        }

    </script>
</body>
</html>
