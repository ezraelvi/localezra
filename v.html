<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width"> 
    <title>Elvi Ezra - Cosmic Orb</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        /* General Body Styles */
        body {
            margin: 0;
            font-family: 'Space Mono', monospace; /* Futuristic font */
            color: #E0E0E0; /* Light gray for text on dark background */
            background-color: #000005; /* Near black for deep space background */
            overflow: auto; /* Allow scrolling for the large content area */
            cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 24 24" fill="%2300FFFF"><circle cx="12" cy="12" r="2" opacity="0.8"/><path d="M12 0L12 6M0 12L6 12M12 18L12 24M18 12L24 12" stroke="%2300FFFF" stroke-width="2"/></svg>') 15 15, auto; /* Custom cursor */
            perspective: 1000px; /* For 3D effects */
        }

        .background-stars {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: radial-gradient(white, rgba(255,255,255,.2) 2px, transparent 40px), radial-gradient(white, rgba(255,255,255,.15) 1px, transparent 30px), radial-gradient(white, rgba(255,255,255,.1) 2px, transparent 40px);
            background-size: 500px 500px, 300px 300px, 200px 200px;
            background-position: 0 0, 50px 50px, 100px 100px;
            animation: moveStars 100s linear infinite;
            z-index: -1;
        }

        @keyframes moveStars {
            from { background-position: 0 0, 50px 50px, 100px 100px; }
            to { background-position: 500px 500px, 350px 350px, 300px 300px; }
        }

        .container {
            max-width: 900px;
            margin: 50px auto;
            padding: 40px;
            background-color: rgba(10, 10, 20, 0.9); /* Slightly transparent dark background for content */
            border-radius: 15px;
            box-shadow: 0 0 30px rgba(0, 255, 255, 0.4); /* Cyan glow */
            position: relative;
            z-index: 1;
            transform-style: preserve-3d;
            animation: fadeIn 1s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Header and Profile */
        .profile-header {
            text-align: center;
            margin-bottom: 40px;
            position: relative;
        }

        .profile-picture {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            border: 4px solid #00FFFF; /* Cyan border */
            object-fit: cover;
            margin-bottom: 20px;
            box-shadow: 0 0 15px rgba(0, 255, 255, 0.6);
            transition: transform 0.3s ease;
        }

        .profile-picture:hover {
            transform: scale(1.05) rotate(5deg);
        }

        .name-and-title h1 {
            font-size: 2.8em;
            color: #00FFFF; /* Cyan for name */
            margin-bottom: 5px;
            text-shadow: 0 0 10px rgba(0, 255, 255, 0.8);
        }

        .name-and-title p {
            font-size: 1.2em;
            color: #99FFFF; /* Lighter cyan for title */
            margin-top: 0;
            text-shadow: 0 0 8px rgba(0, 255, 255, 0.5);
        }

        /* Bio Section */
        .bio-section {
            background-color: rgba(20, 20, 40, 0.7);
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 40px;
            border: 1px solid #00AAFF; /* Blue border */
            box-shadow: 0 0 20px rgba(0, 170, 255, 0.3);
        }

        .bio-section h2 {
            color: #00AAFF; /* Blue for heading */
            text-align: center;
            margin-bottom: 20px;
            font-size: 1.8em;
            text-shadow: 0 0 8px rgba(0, 170, 255, 0.6);
        }

        .bio-section p {
            line-height: 1.8;
            font-size: 1.1em;
            text-align: justify;
            color: #B0E0E6; /* Pale cyan for bio text */
        }

        /* Core Metrics Section - NEW */
        .core-metrics {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 25px;
            margin-bottom: 50px;
        }

        .metric-item {
            background-color: rgba(30, 30, 50, 0.8);
            border-radius: 12px;
            padding: 25px;
            text-align: center;
            flex: 1;
            min-width: 250px;
            box-shadow: 0 0 20px rgba(128, 0, 128, 0.4); /* Purple glow */
            border: 1px solid #8A2BE2; /* BlueViolet border */
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .metric-item:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 0 35px rgba(128, 0, 128, 0.6);
        }

        .metric-item .icon-large {
            font-size: 3.8em;
            color: #DDA0DD; /* Plum color for icon */
            margin-bottom: 15px;
            text-shadow: 0 0 10px rgba(221, 160, 221, 0.8);
        }

        .metric-item h2 {
            font-size: 2.4em;
            color: #EE82EE; /* Violet color for number */
            margin-bottom: 8px;
            text-shadow: 0 0 12px rgba(238, 130, 238, 0.8);
        }

        .metric-item p {
            color: #FFC0CB; /* Pink color for description */
            font-size: 1.1em;
            margin-top: 0;
        }


        /* Social Links */
        .social-links {
            text-align: center;
            margin-bottom: 40px;
        }

        .social-links a {
            color: #00FFFF;
            font-size: 2.5em;
            margin: 0 15px;
            transition: color 0.3s ease, transform 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .social-links a:hover {
            color: #99FFFF;
            transform: scale(1.2);
        }

        /* Footer */
        footer {
            text-align: center;
            margin-top: 50px;
            padding-top: 30px;
            border-top: 1px solid rgba(0, 255, 255, 0.2);
            color: #99FFFF;
            font-size: 0.9em;
            text-shadow: 0 0 5px rgba(0, 255, 255, 0.3);
        }

        /* Editor Overlay Styles */
        .editor-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(8px);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .editor-overlay.active {
            display: flex;
        }

        .editor-content {
            background-color: #1a1a2e; /* Dark blue-purple */
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 0 40px rgba(138, 43, 226, 0.7); /* Amethyst glow */
            width: 90%;
            max-width: 600px;
            color: #E0E0E0;
            position: relative;
            animation: popIn 0.4s cubic-bezier(0.68, -0.55, 0.27, 1.55);
            max-height: 90vh; /* Limit height */
            overflow-y: auto; /* Allow scrolling within the editor */
        }

        @keyframes popIn {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .editor-content h2 {
            color: #FF69B4; /* Hot pink */
            text-align: center;
            margin-bottom: 25px;
            font-size: 2.2em;
            text-shadow: 0 0 10px rgba(255, 105, 180, 0.7);
        }

        .editor-content label {
            display: block;
            margin-bottom: 10px;
            color: #C0C0C0;
            font-size: 1.1em;
        }

        .editor-content input[type="text"],
        .editor-content textarea {
            width: calc(100% - 20px);
            padding: 12px;
            margin-bottom: 20px;
            border: 1px solid #4a4a6e;
            border-radius: 8px;
            background-color: #2a2a4a;
            color: #E0E0E0;
            font-family: 'Space Mono', monospace;
            font-size: 1em;
            box-sizing: border-box;
            box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.5);
        }

        .editor-content textarea {
            min-height: 120px;
            resize: vertical;
        }

        .editor-actions {
            display: flex;
            justify-content: space-around;
            gap: 15px;
            margin-top: 30px;
        }

        .editor-actions button {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-size: 1.1em;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            flex: 1;
        }

        .editor-actions button:hover {
            transform: translateY(-3px);
        }

        .editor-actions .publish-btn {
            background-color: #4CAF50; /* Green */
            color: white;
            box-shadow: 0 0 15px rgba(76, 175, 80, 0.5);
        }

        .editor-actions .publish-btn:hover {
            background-color: #45a049;
        }

        .editor-actions .cancel-btn {
            background-color: #f44336; /* Red */
            color: white;
            box-shadow: 0 0 15px rgba(244, 67, 54, 0.5);
        }

        .editor-actions .cancel-btn:hover {
            background-color: #da190b;
        }

        .close-editor-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            color: #E0E0E0;
            font-size: 2em;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .close-editor-btn:hover {
            color: #FF69B4;
        }

        /* Upload Section */
        .upload-section {
            background-color: rgba(20, 20, 40, 0.7);
            border: 1px dashed #00AAFF;
            border-radius: 10px;
            padding: 30px;
            text-align: center;
            margin-bottom: 40px;
            box-shadow: 0 0 20px rgba(0, 170, 255, 0.3);
        }

        .upload-section h2 {
            color: #00AAFF;
            margin-bottom: 25px;
            font-size: 1.8em;
            text-shadow: 0 0 8px rgba(0, 170, 255, 0.6);
        }

        #uploadForm input[type="file"] {
            display: block;
            margin: 0 auto 20px auto;
            padding: 10px;
            border: 1px solid #4a4a6e;
            border-radius: 8px;
            width: fit-content;
            background-color: #2a2a4a;
            color: #E0E0E0;
            font-family: 'Space Mono', monospace;
            cursor: pointer;
        }

        #uploadForm button {
            background-color: #6A5ACD; /* SlateBlue */
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-size: 1.1em;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            box-shadow: 0 0 15px rgba(106, 90, 205, 0.5);
        }

        #uploadForm button:hover {
            background-color: #483D8B; /* DarkSlateBlue */
            transform: translateY(-3px);
        }

        #uploadStatus {
            margin-top: 15px;
            font-size: 1em;
            color: #FFD700; /* Gold */
        }
        
        /* Media Query for Responsiveness */
        @media (max-width: 768px) {
            .container {
                margin: 30px auto;
                padding: 25px;
            }

            .profile-header h1 {
                font-size: 2.2em;
            }

            .profile-header p {
                font-size: 1em;
            }

            .bio-section h2, .upload-section h2 {
                font-size: 1.5em;
            }

            .bio-section p {
                font-size: 1em;
            }

            .core-metrics {
                flex-direction: column;
                align-items: center;
            }

            .metric-item {
                min-width: unset;
                width: 100%;
            }

            .metric-item h2 {
                font-size: 2em;
            }

            .metric-item .icon-large {
                font-size: 3em;
            }

            .social-links a {
                font-size: 2em;
                margin: 0 10px;
            }
        }

        @media (max-width: 480px) {
            .container {
                margin: 20px auto;
                padding: 20px;
            }

            .profile-picture {
                width: 100px;
                height: 100px;
            }

            .profile-header h1 {
                font-size: 1.8em;
            }
            .profile-header p {
                font-size: 0.9em;
            }

            .editor-content {
                padding: 20px;
            }

            .editor-content h2 {
                font-size: 1.8em;
            }

            .editor-actions button {
                padding: 10px 20px;
                font-size: 1em;
            }
        }
    </style>
</head>
<body>
    <div class="background-stars"></div>

    <div class="container">
        <header class="profile-header">
            <img id="profilePic" src="https://via.placeholder.com/150/00FFFF/000000?text=ELVI" alt="Profile Picture of Elvi" class="profile-picture">
            <div class="name-and-title">
                <h1 id="profileName">Elvi Ezra</h1>
                <p id="profileTitle">Cosmic Orb</p>
            </div>
            <button id="editProfileBtn" style="position: absolute; top: 10px; right: 10px; background-color: #8A2BE2; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer;">
                <i class="fas fa-edit"></i> Edit Profile
            </button>
        </header>

        <section class="core-metrics">
            <div class="metric-item">
                <i class="fas fa-eye icon-large"></i>
                <h2 id="website-visits">Memuat...</h2>
                <p>Total Kunjungan</p>
            </div>

            <div class="metric-item">
                <i class="fas fa-folder-open icon-large"></i>
                <h2 id="media-count">Memuat...</h2>
                <p>Media Tersimpan</p>
            </div>

            <div class="metric-item">
                <i class="fas fa-clock icon-large"></i>
                <h2 id="website-age">Memuat...</h2>
                <p>Usia Website</p>
            </div>
        </section>

        <section class="bio-section">
            <h2>Cosmic Bio</h2>
            <p id="profileBio">
                Connecting the dots in the vast expanse of the digital cosmos. I'm a passionate explorer of technology and creativity, constantly seeking new galaxies of innovation. This cosmic orb is my personal space where thoughts, projects, and explorations converge. Join me on this journey through the digital universe.
            </p>
        </section>

        <section class="upload-section">
            <h2>Unggah Media Kosmik</h2>
            <form id="uploadForm">
                <input type="file" id="mediaFile" name="mediaFile" multiple>
                <button type="submit">Unggah ke Orb</button>
                <p id="uploadStatus"></p>
            </form>
        </section>

        <section class="social-links">
            <a href="#" onclick="openTikTok()"><i class="fab fa-tiktok"></i></a>
            <a href="#" onclick="openInstagram()"><i class="fab fa-instagram"></i></a>
            </section>

        <footer>
            <p>&copy; 2025 Elvi Ezra - Cosmic Orb. All rights reserved.</p>
        </footer>
    </div>

    <div id="editorOverlay" class="editor-overlay">
        <div class="editor-content">
            <button class="close-editor-btn" id="closeEditorBtn">&times;</button>
            <h2>Edit Cosmic Profile</h2>
            <label for="editorName">Nama:</label>
            <input type="text" id="editorName">

            <label for="editorTitle">Judul:</label>
            <input type="text" id="editorTitle">

            <label for="editorBio">Bio:</label>
            <textarea id="editorBio"></textarea>

            <div class="editor-actions">
                <button class="publish-btn" id="publishChangesBtn">Publish Changes</button>
                <button class="cancel-btn" id="cancelEditBtn">Cancel</button>
            </div>
        </div>
    </div>

    <script>
        // Data default (akan di-override oleh data dari Cloudflare Worker jika tersedia)
        let profileData = {
            name: "Elvi Ezra",
            title: "Cosmic Orb",
            bio: "Connecting the dots in the vast expanse of the digital cosmos. I'm a passionate explorer of technology and creativity, constantly seeking new galaxies of innovation. This cosmic orb is my personal space where thoughts, projects, and explorations converge. Join me on this journey through the digital universe."
        };

        // DOMContentLoaded memastikan script berjalan setelah HTML dimuat sepenuhnya
        document.addEventListener('DOMContentLoaded', () => {
            const profileName = document.getElementById('profileName');
            const profileTitle = document.getElementById('profileTitle');
            const profileBio = document.getElementById('profileBio');
            const editProfileBtn = document.getElementById('editProfileBtn');
            const editorOverlay = document.getElementById('editorOverlay');
            const closeEditorBtn = document.getElementById('closeEditorBtn');
            const cancelEditBtn = document.getElementById('cancelEditBtn');
            const editorName = document.getElementById('editorName');
            const editorTitle = document.getElementById('editorTitle');
            const editorBio = document.getElementById('editorBio');
            const publishChangesBtn = document.getElementById('publishChangesBtn');

            // --- API Base URL for Cloudflare Worker ---
            // PENTING: Ganti ini dengan URL Cloudflare Worker Anda setelah di-deploy!
            const API_BASE_URL = 'https://your-worker-name.your-username.workers.dev'; 
            // Contoh: 'https://elvi-cosmic-worker.yourname.workers.dev'


            // --- Fungsi untuk memuat data profil (dari Cloudflare Worker atau default) ---
            async function fetchDataFromBackend() {
                try {
                    const response = await fetch(`${API_BASE_URL}/profile`);
                    if (!response.ok) {
                        // Jika tidak ada data profil di backend, gunakan data default
                        console.warn('No profile data found on backend, using default.');
                        loadProfileContent(); // Load default local data
                        return;
                    }
                    const data = await response.json();
                    profileData = data; // Update global profileData
                    loadProfileContent(); // Load content with fetched data
                } catch (error) {
                    console.error('Error fetching profile data from backend:', error);
                    loadProfileContent(); // Load default local data if fetch fails
                }
            }

            function loadProfileContent() {
                profileName.textContent = profileData.name;
                profileTitle.textContent = profileData.title;
                profileBio.textContent = profileData.bio;
            }

            // --- Fungsi untuk menyimpan data profil ke backend (Cloudflare Worker) ---
            async function publishChangesToBackend() {
                const updatedProfile = {
                    name: editorName.value,
                    title: editorTitle.value,
                    bio: editorBio.value
                };

                try {
                    const response = await fetch(`${API_BASE_URL}/profile`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(updatedProfile)
                    });

                    if (!response.ok) {
                        const errorText = await response.text();
                        throw new Error(`HTTP error! status: ${response.status}, message: ${errorText}`);
                    }

                    const result = await response.json();
                    console.log('Changes published to Cloudflare Worker:', result);
                    alert('Changes successfully published to the galaxy!');
                    editorOverlay.classList.remove('active');
                    profileData = updatedProfile; // Update local data
                    loadProfileContent(); // Reload the website with the new data
                } catch (error) {
                    console.error('Error publishing changes:', error);
                    alert(`Failed to publish changes: ${error.message}. Check Cloudflare Worker logs.`);
                }
            }

            // --- Event Listeners for Editor ---
            editProfileBtn.addEventListener('click', () => {
                editorName.value = profileData.name;
                editorTitle.value = profileData.title;
                editorBio.value = profileData.bio;
                editorOverlay.classList.add('active');
            });

            closeEditorBtn.addEventListener('click', () => {
                editorOverlay.classList.remove('active');
            });

            cancelEditBtn.addEventListener('click', () => {
                editorOverlay.classList.remove('active');
            });

            publishChangesBtn.addEventListener('click', publishChangesToBackend);


            // --- NEW FEATURE 1: Website Age ---
            // Ganti dengan tanggal peluncuran website Anda yang sebenarnya (tahun, bulan-1, hari, jam, menit, detik)
            // Contoh: 20 Juni 2024 -> new Date(2024, 5, 20, 0, 0, 0)
            const WEBSITE_BUILD_DATE = new Date(2024, 5, 20, 0, 0, 0); 

            function updateWebsiteAge() {
                const now = new Date();
                const diffMs = now - WEBSITE_BUILD_DATE;

                const seconds = Math.floor(diffMs / 1000);
                const minutes = Math.floor(seconds / 60);
                const hours = Math.floor(minutes / 60);
                const days = Math.floor(hours / 24);

                // Perhitungan tahun dan bulan yang lebih akurat
                let years = now.getFullYear() - WEBSITE_BUILD_DATE.getFullYear();
                let months = now.getMonth() - WEBSITE_BUILD_DATE.getMonth();
                let remainingDays = now.getDate() - WEBSITE_BUILD_DATE.getDate();

                if (remainingDays < 0) {
                    months--;
                    remainingDays += new Date(now.getFullYear(), now.getMonth(), 0).getDate(); // Days in previous month
                }
                if (months < 0) {
                    years--;
                    months += 12;
                }

                const sisaHours = hours % 24;
                const sisaMinutes = minutes % 60;
                const sisaSeconds = seconds % 60;

                document.getElementById('website-age').innerText = 
                    `${years}y ${months}m ${remainingDays}d\n${sisaHours}h ${sisaMinutes}m ${sisaSeconds}s`;
            }

            // Panggil sekali saat DOM dimuat
            updateWebsiteAge();
            // Update setiap detik
            setInterval(updateWebsiteAge, 1000);


            // --- NEW FEATURE 2 & 3: Kunjungan Website & Jumlah Media (Membutuhkan Backend) ---
            async function fetchWebsiteStats() {
                try {
                    const response = await fetch(`${API_BASE_URL}/stats`);
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    const data = await response.json();
                    
                    document.getElementById('website-visits').innerText = data.visits.toLocaleString();
                    document.getElementById('media-count').innerText = data.mediaCount.toLocaleString();

                } catch (error) {
                    console.error('Gagal mengambil statistik website:', error);
                    document.getElementById('website-visits').innerText = 'Error!';
                    document.getElementById('media-count').innerText = 'Error!';
                }
            }

            async function recordVisit() {
                try {
                    // Mengirim request untuk mencatat kunjungan
                    await fetch(`${API_BASE_URL}/visit`, { method: 'POST' });
                    // Setelah mencatat kunjungan, ambil statistik terbaru
                    fetchWebsiteStats();
                } catch (error) {
                    console.error('Gagal mencatat kunjungan:', error);
                    // Masih mencoba mengambil statistik terakhir yang mungkin ada
                    fetchWebsiteStats(); 
                }
            }

            // Panggil fungsi ini saat halaman dimuat
            recordVisit(); // Mencatat kunjungan dan kemudian mengambil statistik

            // --- NEW FEATURE: Unggah Media ---
            const uploadForm = document.getElementById('uploadForm');
            const uploadStatus = document.getElementById('uploadStatus');

            uploadForm.addEventListener('submit', async (event) => {
                event.preventDefault(); // Mencegah form reload halaman

                const fileInput = document.getElementById('mediaFile');
                const files = fileInput.files;

                if (files.length === 0) {
                    uploadStatus.textContent = 'Pilih setidaknya satu file untuk diunggah.';
                    uploadStatus.style.color = '#FFD700'; // Gold color for warnings
                    return;
                }

                uploadStatus.textContent = 'Mengunggah...';
                uploadStatus.style.color = '#ADD8E6'; // Light blue for status

                const formData = new FormData();
                for (let i = 0; i < files.length; i++) {
                    formData.append('mediaFiles', files[i]); // 'mediaFiles' harus sesuai dengan nama field di Worker
                }

                try {
                    const response = await fetch(`${API_BASE_URL}/upload`, {
                        method: 'POST',
                        body: formData,
                    });

                    if (response.ok) {
                        const result = await response.json();
                        uploadStatus.textContent = `Berhasil mengunggah ${result.uploadedCount} file!`;
                        uploadStatus.style.color = '#90EE90'; // Light Green for success
                        fileInput.value = ''; // Reset input file
                        fetchWebsiteStats(); // Perbarui hitungan media setelah unggah
                    } else {
                        const errorData = await response.json();
                        throw new Error(errorData.error || `Gagal mengunggah: ${response.statusText}`);
                    }
                } catch (error) {
                    console.error('Error saat mengunggah:', error);
                    uploadStatus.textContent = `Gagal mengunggah: ${error.message}`;
                    uploadStatus.style.color = '#FF6347'; // Tomato for errors
                }
            });


            // Global functions (not part of DOMContentLoaded, can be called from HTML)
            function openTikTok() {
                window.open("https://vm.tiktok.com/ZShf4GMgT/", "_blank");
            }

            function openInstagram() {
                window.open("https://www.instagram.com/elvizill/", "_blank");
            }

            // Call fetchDataFromBackend on initial load to populate the website with live data
            fetchDataFromBackend(); 
            // Initial load of profile data. recordVisit() above will fetch stats.
        });
    </script>
</body>
</html>
